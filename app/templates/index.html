{% extends "base.html" %}

{% block title %}Popular Movies{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1>Popular Movies</h1>

    <div id="movie-list" class="list-group">
        <!-- Сюди буде довантажуватись список через JavaScript -->
    </div>

    <div class="d-grid mt-4">
        <button id="load-more" class="btn btn-primary">Show More</button>
    </div>
</div>

<script>
const movies = JSON.parse('{{ movies_json|safe }}');
let currentIndex = 0;
const moviesPerPage = 8;

function showMoreMovies() {
    const movieList = document.getElementById('movie-list');
    for (let i = currentIndex; i < currentIndex + moviesPerPage && i < movies.length; i++) {
        const a = document.createElement('a');
        a.className = 'list-group-item list-group-item-action';
        a.href = `/movie/${movies[i].id}`;
        a.innerHTML = `
            <h5 class="mb-1">${movies[i].title}</h5>
            <small>Release: ${movies[i].release || "Unknown"}, IMDb Score: ${movies[i].imdb_score || "N/A"}</small>
        `;
        movieList.appendChild(a);
    }
    currentIndex += moviesPerPage;
    if (currentIndex >= movies.length) {
        document.getElementById('load-more').style.display = 'none';
    }
}

document.getElementById('load-more')?.addEventListener('click', showMoreMovies);
document.addEventListener('DOMContentLoaded', showMoreMovies);
</script>

{% endblock %}
